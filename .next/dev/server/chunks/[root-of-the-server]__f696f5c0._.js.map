{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Dell/OneDrive%20-%20Alliance%20University/Desktop/git/v0-sql-connected-website/app/api/auth/signup/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { neon } from \"@neondatabase/serverless\"\r\n\r\nconst sql = neon(process.env.DATABASE_URL as string)\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password, username, fullName } = await request.json()\r\n\r\n    if (!email || !password || !username) {\r\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\r\n    }\r\n\r\n    // Create a simple dummy user without database dependency\r\n    const user = {\r\n      id: Math.random().toString(36).substring(7),\r\n      email,\r\n      username,\r\n      full_name: fullName || username,\r\n    }\r\n\r\n    // âœ… Log signup event into login_events table (Neon DB)\r\n    try {\r\n      await sql`\r\n        INSERT INTO login_events (email, event_type)\r\n        VALUES (${email}, 'signup')\r\n      `\r\n    } catch (dbError) {\r\n      console.error(\"[v0] Failed to log signup event:\", dbError)\r\n      // we don't block signup if logging fails\r\n    }\r\n\r\n    const response = NextResponse.json({\r\n      success: true,\r\n      user: {\r\n        id: user.id,\r\n        email: user.email,\r\n        username: user.username,\r\n        fullName: user.full_name,\r\n      },\r\n    })\r\n\r\n    response.cookies.set(\"auth\", JSON.stringify(user), {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      sameSite: \"lax\",\r\n      maxAge: 7 * 24 * 60 * 60, // 7 days\r\n    })\r\n\r\n    return response\r\n  } catch (error) {\r\n    console.error(\"[v0] Signup error:\", error)\r\n    return NextResponse.json({ error: \"Failed to create account\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,MAAM,IAAA,gKAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AAElC,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAElE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU;YACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,yDAAyD;QACzD,MAAM,OAAO;YACX,IAAI,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC;YACzC;YACA;YACA,WAAW,YAAY;QACzB;QAEA,uDAAuD;QACvD,IAAI;YACF,MAAM,GAAG,CAAC;;gBAEA,EAAE,MAAM;MAClB,CAAC;QACH,EAAE,OAAO,SAAS;YAChB,QAAQ,KAAK,CAAC,oCAAoC;QAClD,yCAAyC;QAC3C;QAEA,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC,SAAS;YACT,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;gBACvB,UAAU,KAAK,SAAS;YAC1B;QACF;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,SAAS,CAAC,OAAO;YACjD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,IAAI,KAAK,KAAK;QACxB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF"}}]
}